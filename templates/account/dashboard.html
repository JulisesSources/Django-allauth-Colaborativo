<!-- templates/accounts/dashboard.html -->
{% extends 'base.html' %}

{% block title %}Dashboard - SCA-B123{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Header -->
    <div class="bg-white shadow rounded-lg p-6">
        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-3xl font-bold text-gray-900">
                    <i class="fas fa-home text-blue-600 mr-2"></i>
                    Bienvenido, {{ user.username|default:user.email }}
                </h1>
                <p class="text-gray-600 mt-2">
                    Rol: <span class="font-semibold">{{ perfil.get_rol_display }}</span>
                </p>
            </div>
            <div class="text-right">
                <p class="text-sm text-gray-500">Último acceso</p>
                <p class="text-lg font-semibold">{{ user.last_login|date:"d/m/Y H:i" }}</p>
            </div>
        </div>
    </div>
    
    <!-- Estadísticas según rol -->
    {% if es_admin %}
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="bg-white shadow rounded-lg p-6">
            <div class="flex items-center">
                <div class="flex-shrink-0 bg-blue-500 rounded-md p-3">
                    <i class="fas fa-users text-white text-2xl"></i>
                </div>
                <div class="ml-4">
                    <p class="text-sm text-gray-500">Total Usuarios</p>
                    <p class="text-2xl font-bold text-gray-900">{{ total_usuarios }}</p>
                </div>
            </div>
        </div>
        
        <div class="bg-white shadow rounded-lg p-6">
            <div class="flex items-center">
                <div class="flex-shrink-0 bg-green-500 rounded-md p-3">
                    <i class="fas fa-user-tie text-white text-2xl"></i>
                </div>
                <div class="ml-4">
                    <p class="text-sm text-gray-500">Total Trabajadores</p>
                    <p class="text-2xl font-bold text-gray-900">{{ total_trabajadores }}</p>
                </div>
            </div>
        </div>
        
        <div class="bg-white shadow rounded-lg p-6">
            <div class="flex items-center">
                <div class="flex-shrink-0 bg-yellow-500 rounded-md p-3">
                    <i class="fas fa-calendar-alt text-white text-2xl"></i>
                </div>
                <div class="ml-4">
                    <p class="text-sm text-gray-500">Fecha</p>
                    <p class="text-lg font-bold text-gray-900">{{ today|date:"d/m/Y" }}</p>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    
    <!-- Accesos rápidos -->
    <div class="bg-white shadow rounded-lg p-6">
        <h2 class="text-xl font-bold text-gray-900 mb-4">
            <i class="fas fa-bolt text-yellow-500 mr-2"></i>
            Accesos Rápidos
        </h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <!-- Todos pueden ver su perfil -->
            <a href="{% url 'accounts:mi_perfil' %}" class="block p-4 border-2 border-gray-200 rounded-lg hover:border-blue-500 hover:shadow-md transition">
                <i class="fas fa-user text-blue-500 text-3xl mb-2"></i>
                <h3 class="font-semibold text-gray-900">Mi Perfil</h3>
                <p class="text-sm text-gray-600">Ver y editar mi información</p>
            </a>
       
            {% if es_admin %}
            <a href="{% url 'accounts:lista_usuarios' %}" class="block p-4 border-2 border-gray-200 rounded-lg hover:border-purple-500 hover:shadow-md transition">
                <i class="fas fa-users-cog text-purple-500 text-3xl mb-2"></i>
                <h3 class="font-semibold text-gray-900">Usuarios</h3>
                <p class="text-sm text-gray-600">Administrar usuarios</p>
            </a>
            {% endif %}
            
            <a href="{% url 'account_change_password' %}" class="block p-4 border-2 border-gray-200 rounded-lg hover:border-red-500 hover:shadow-md transition">
                <i class="fas fa-key text-red-500 text-3xl mb-2"></i>
                <h3 class="font-semibold text-gray-900">Seguridad</h3>
                <p class="text-sm text-gray-600">Cambiar contraseña</p>
            </a>
        </div>
    </div>
    
    <!-- Información del trabajador si existe -->
    {% if mi_trabajador %}
    <div class="bg-white shadow rounded-lg p-6">
        <h2 class="text-xl font-bold text-gray-900 mb-4">
            <i class="fas fa-id-card text-blue-500 mr-2"></i>
            Mi Información Laboral
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
                <p class="text-sm text-gray-500">Número de Empleado</p>
                <p class="font-semibold">{{ mi_trabajador.numero_empleado }}</p>
            </div>
            <div>
                <p class="text-sm text-gray-500">Unidad Administrativa</p>
                <p class="font-semibold">{{ mi_trabajador.id_unidad.nombre }}</p>
            </div>
            <div>
                <p class="text-sm text-gray-500">Puesto</p>
                <p class="font-semibold">{{ mi_trabajador.id_puesto.nombre_puesto }}</p>
            </div>
            <div>
                <p class="text-sm text-gray-500">Tipo de Nombramiento</p>
                <p class="font-semibold">{{ mi_trabajador.id_tipo_nombramiento.descripcion }}</p>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}